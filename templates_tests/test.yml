---
tests:
  # test templates/docker-compose.yml.j2

  - name: default Docker Compose file
    template: docker-compose.yml.j2
    expected_result: compose/default/docker-compose.yml

  - name: custom Docker Compose file
    template: docker-compose.yml.j2
    variables:
      inventory: compose/custom/inventory.yml
    expected_result: compose/custom/docker-compose.yml

  # test templates/gitlab.rb.j2

  - name: default config
    template: gitlab.rb.j2
    expected_result: config/default/gitlab.rb

  - name: custom URL settings
    template: gitlab.rb.j2
    variables:
      inventory: config/url/inventory.yml
    expected_result: config/url/gitlab.rb

  - name: set gitlab_unicorn_workers
    template: gitlab.rb.j2
    variables:
      inventory: config/unicorn_workers/inventory.yml
    expected_result: config/unicorn_workers/gitlab.rb

  - name: set gitlab_monitoring_whitelist (single entry)
    template: gitlab.rb.j2
    variables:
      inventory: config/monitoring_whitelist/single_entry/inventory.yml
    expected_result: config/monitoring_whitelist/single_entry/gitlab.rb

  - name: set gitlab_monitoring_whitelist (multiple entries)
    template: gitlab.rb.j2
    variables:
      inventory: config/monitoring_whitelist/multiple_entries/inventory.yml
    expected_result: config/monitoring_whitelist/multiple_entries/gitlab.rb

  - name: SMTPS
    template: gitlab.rb.j2
    variables:
      inventory: config/email/tls/inventory.yml
    expected_result: config/email/tls/gitlab.rb

  - name: STARTTLS
    template: gitlab.rb.j2
    variables:
      inventory: config/email/starttls/inventory.yml
    expected_result: config/email/starttls/gitlab.rb

  - name: insecure transport
    template: gitlab.rb.j2
    variables:
      inventory: config/email/insecure_transport/inventory.yml
    expected_result: config/email/insecure_transport/gitlab.rb

  - name: unverified certificate
    template: gitlab.rb.j2
    variables:
      inventory: config/email/unverified_cert/inventory.yml
    expected_result: config/email/unverified_cert/gitlab.rb

  - name: private CA
    template: gitlab.rb.j2
    variables:
      inventory: config/email/private_ca/inventory.yml
    expected_result: config/email/private_ca/gitlab.rb
